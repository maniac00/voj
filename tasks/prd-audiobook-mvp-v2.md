# 📄 PRD: 시각장애인용 오디오북 스트리밍 MVP v2.0

## 1. 개요 (Overview)

시각장애인을 위한 오디오북 서비스의 핵심 워크플로우를 검증하는 MVP를 구축합니다. 관리자가 웹 어드민에서 책과 오디오 파일을 업로드하면 자동 인코딩을 거쳐 스트리밍 가능한 상태로 변환되는 전체 파이프라인의 정상 작동을 목표로 합니다.

**핵심 가치 제안**: 업로드→인코딩→스트리밍의 완전 자동화된 워크플로우

## 2. 목표 (Goals)

### 주요 목표
1. **워크플로우 검증**: 오디오 파일 업로드부터 스트리밍까지 전체 파이프라인이 에러 없이 작동
2. **사용성 확인**: 관리자가 직관적으로 책과 오디오를 관리할 수 있는 UI 제공
3. **기술 스택 검증**: AWS 서비스 조합(S3+CloudFront+DynamoDB+Lambda)의 실제 동작 확인
4. **접근성 기반 확인**: 시각장애인 사용자를 고려한 기본적인 접근성 준수

### 성공 지표
- ✅ 관리자가 WAV 파일 업로드 → AAC 자동 인코딩 → 스트리밍 URL 생성까지 완료
- ✅ 어드민 페이지에서 업로드된 오디오 직접 재생 가능
- ✅ 로컬/AWS 환경 모두에서 동일한 워크플로우 동작
- ✅ 인코딩 실패/성공 상태가 실시간으로 로그에 표시

## 3. 사용자 스토리 (User Stories)

### 관리자 (Primary User)
1. **AS** 관리자, **I WANT TO** 간단한 로그인으로 어드민에 접근하고, **SO THAT** 권한 없는 사용자의 접근을 방지할 수 있다
2. **AS** 관리자, **I WANT TO** 책 제목/저자를 입력해 새 책을 생성하고, **SO THAT** 오디오 파일을 업로드할 수 있는 컨테이너를 만들 수 있다
3. **AS** 관리자, **I WANT TO** WAV 파일을 선택해 업로드하고, **SO THAT** 자동으로 스트리밍 가능한 형태로 변환될 수 있다
4. **AS** 관리자, **I WANT TO** 업로드한 오디오의 인코딩 상태를 실시간으로 확인하고, **SO THAT** 처리 과정을 모니터링할 수 있다
5. **AS** 관리자, **I WANT TO** 어드민 페이지에서 직접 오디오를 재생해보고, **SO THAT** 스트리밍이 정상 작동하는지 즉시 확인할 수 있다

### 개발자 (Secondary User)
6. **AS** 개발자, **I WANT TO** 로컬 환경과 AWS 환경을 쉽게 전환하고, **SO THAT** 개발과 프로덕션 테스트를 효율적으로 할 수 있다

## 4. 기능 요구사항 (Functional Requirements)

### 4.1 인증 및 접근 제어
1. **FR-1**: 시스템은 하드코딩된 단일 관리자 계정(admin/admin123)으로 로그인을 지원해야 한다
2. **FR-2**: 로그인하지 않은 사용자는 로그인 페이지로 리디렉션되어야 한다
3. **FR-3**: 로그인 상태는 세션 또는 토큰으로 유지되어야 한다

### 4.2 책 관리
4. **FR-4**: 관리자는 책 제목, 저자, 출판사를 입력해 새 책을 생성할 수 있어야 한다
5. **FR-5**: 시스템은 생성된 책 목록을 테이블 형태로 표시해야 한다
6. **FR-6**: 각 책 항목에서 상세 페이지로 이동할 수 있어야 한다
7. **FR-7**: 책 정보를 수정하고 삭제할 수 있어야 한다

### 4.3 오디오 업로드 및 관리
8. **FR-8**: 관리자는 파일 선택 버튼을 통해 WAV 오디오 파일을 업로드할 수 있어야 한다
9. **FR-9**: 업로드된 파일은 자동으로 S3(또는 로컬 스토리지)에 저장되어야 한다
10. **FR-10**: 시스템은 업로드 완료 후 자동으로 FFmpeg 인코딩 작업을 시작해야 한다
11. **FR-11**: 인코딩은 WAV → AAC (M4A, 56kbps, 모노) 형식으로 변환해야 한다
12. **FR-12**: 각 오디오 파일의 상태(업로드중, 인코딩중, 완료, 오류)가 실시간으로 표시되어야 한다

### 4.4 상태 모니터링 및 로그
13. **FR-13**: 인코딩 과정의 로그 메시지가 어드민 페이지에 표시되어야 한다
14. **FR-14**: 오류 발생 시 구체적인 오류 메시지와 해결 방법이 제시되어야 한다
15. **FR-15**: 각 오디오 파일의 메타데이터(재생시간, 파일크기, 비트레이트)가 표시되어야 한다

### 4.5 스트리밍 및 재생 테스트
16. **FR-16**: 인코딩 완료된 오디오는 어드민 페이지에서 직접 재생할 수 있어야 한다
17. **FR-17**: 로컬 환경에서는 로컬 파일 URL로, AWS 환경에서는 CloudFront Signed URL로 스트리밍해야 한다
18. **FR-18**: 오디오 플레이어는 재생/일시정지, 진행률 표시, 볼륨 조절을 지원해야 한다

### 4.6 환경별 지원
19. **FR-19**: 환경 변수를 통해 로컬/AWS 환경을 자동 감지하고 적절한 서비스를 사용해야 한다
20. **FR-20**: 로컬 환경에서는 DynamoDB Local, 파일 시스템 스토리지를 사용해야 한다
21. **FR-21**: AWS 환경에서는 DynamoDB, S3, CloudFront, Lambda를 사용해야 한다

## 5. 비기능 요구사항 (Non-Functional Requirements)

### 5.1 성능
- 100MB 이하의 오디오 파일은 5분 내에 인코딩 완료
- 어드민 페이지 로딩 시간 3초 이내
- 오디오 스트리밍 시작 지연 2초 이내

### 5.2 사용성
- 최소한의 클릭으로 책 생성부터 오디오 업로드까지 완료
- 명확한 상태 표시와 진행률 피드백
- 키보드 내비게이션 지원 (접근성 고려)

### 5.3 신뢰성
- 인코딩 실패 시 자동 재시도 (최대 3회)
- 업로드 중단 시 부분 파일 정리
- 시스템 재시작 후에도 진행 중인 작업 상태 복구

## 6. 범위 외 항목 (Non-Goals)

❌ **현재 MVP에서 제외되는 기능들:**

1. **복잡한 사용자 관리**: 다중 사용자, 역할 기반 권한, 회원가입 기능
2. **고급 오디오 기능**: HLS 멀티비트레이트, 챕터 마커, 자막 동기화
3. **최종 사용자 앱**: 모바일 앱이나 사용자용 웹 플레이어 (관리자 테스트용만)
4. **결제 및 구독**: 상업적 기능들
5. **고급 분석**: 사용 통계, 재생 분석, 대시보드
6. **파일 관리 고급 기능**: 일괄 업로드, 드래그앤드롭, 폴더 구조
7. **고급 보안**: 2FA, 세션 관리, 감사 로그

## 7. UI/UX 설계 고려사항

### 7.1 화면 구성 우선순위
1. **로그인 페이지**: 심플한 ID/Password 입력폼
2. **책 목록 페이지**: 생성된 책들의 테이블뷰 + "새 책 추가" 버튼
3. **책 상세 페이지**: 책 정보 + 오디오 파일 목록 + 업로드 버튼
4. **대시보드**: 전체 현황 요약 (총 책 수, 처리 중인 파일 수 등)

### 7.2 접근성 고려사항
- 명확한 레이블과 alt 텍스트
- 키보드만으로 모든 기능 접근 가능
- 충분한 색상 대비
- 스크린 리더 친화적 구조

### 7.3 반응형 디자인
- 데스크톱 우선 설계 (관리자 도구 특성상)
- 태블릿에서도 사용 가능한 레이아웃

## 8. 기술적 고려사항

### 8.1 아키텍처 제약사항
- **프론트엔드**: Next.js 15 + React 19 + TypeScript
- **백엔드**: FastAPI + Python 3.12+
- **데이터베이스**: DynamoDB (로컬/AWS)
- **스토리지**: 로컬 파일시스템 / S3
- **인코딩**: FFmpeg (로컬 바이너리 / Lambda Layer)

### 8.2 환경별 설정
```bash
# 로컬 개발
ENVIRONMENT=local
STORAGE_TYPE=local
DYNAMODB_ENDPOINT=http://localhost:8001

# AWS 프로덕션  
ENVIRONMENT=production
STORAGE_TYPE=s3
AWS_REGION=ap-northeast-2
```

### 8.3 데이터 모델
```json
// Book
{
  "user_id": "admin",
  "book_id": "uuid",
  "title": "string",
  "author": "string", 
  "publisher": "string",
  "status": "draft|published",
  "created_at": "timestamp"
}

// AudioChapter  
{
  "chapter_id": "uuid",
  "book_id": "uuid",
  "chapter_number": 1,
  "title": "string",
  "status": "uploading|processing|ready|error",
  "file_info": {
    "original_name": "string",
    "file_size": "number",
    "s3_key": "string"
  },
  "audio_metadata": {
    "duration": "number",
    "bitrate": "number", 
    "format": "m4a"
  }
}
```

## 9. 성공 지표 (Success Metrics)

### 9.1 기능적 성공 지표
- [ ] 관리자가 로그인 → 책 생성 → 오디오 업로드 → 재생 테스트까지 10분 내 완료
- [ ] WAV 파일 업로드 후 AAC 인코딩이 자동으로 완료됨
- [ ] 인코딩된 파일이 어드민 페이지에서 정상 재생됨
- [ ] 로컬과 AWS 환경에서 동일한 워크플로우가 작동함

### 9.2 기술적 성공 지표
- [ ] 인코딩 성공률 95% 이상
- [ ] 파일 업로드 성공률 99% 이상  
- [ ] 스트리밍 URL 생성 성공률 99% 이상
- [ ] 시스템 재시작 후 상태 복구 성공률 100%

### 9.3 사용성 성공 지표
- [ ] 첫 사용자도 가이드 없이 기본 워크플로우 완료 가능
- [ ] 에러 발생 시 명확한 메시지와 해결 방법 제시
- [ ] 모든 상태 변화가 실시간으로 UI에 반영

## 10. 미해결 질문 (Open Questions)

1. **인코딩 실패 재시도 정책**: 어떤 오류에서 재시도하고, 언제 포기할 것인가?
2. **파일 크기 제한**: 100MB를 넘는 파일에 대한 처리 방법은?
3. **동시 업로드**: 여러 파일을 동시에 업로드할 때의 큐 관리 방법은?
4. **스토리지 정리**: 실패한 업로드나 삭제된 책의 파일 정리 정책은?
5. **모니터링**: 프로덕션 환경에서의 로그 수집 및 알림 방법은?

## 11. 구현 우선순위

### Phase 1 (Core MVP)
1. 하드코딩 로그인
2. 책 CRUD 기능
3. 파일 업로드 (로컬 환경)
4. 기본 인코딩 파이프라인
5. 상태 표시 및 로그

### Phase 2 (AWS Integration)  
1. AWS 서비스 연동
2. CloudFront 스트리밍
3. 환경별 설정 자동화
4. 에러 처리 고도화

### Phase 3 (Polish)
1. UI/UX 개선
2. 접근성 강화  
3. 성능 최적화
4. 모니터링 및 로그 개선

---

**문서 버전**: v2.0  
**작성일**: 2024-12-13  
**대상 독자**: 주니어 개발자  
**예상 개발 기간**: 2-3주
